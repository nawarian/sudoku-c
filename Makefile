CC=clang
CFLAGS=`pkg-config --cflags raylib`
LIBS=`pkg-config --libs raylib`

MKDIR=mkdir -p
RM=rm -r

SRCDIR=src
BUILDDIR=build
OBJS=$(BUILDDIR)/grid.o \
	 $(BUILDDIR)/solver.o
MAIN=$(BUILDDIR)/main.o
TOBJS=$(BUILDDIR)/solver.test.o
SOLVER=$(BUILDDIR)/solver

SAMPLE_EASY_GRID="690805730518763020374192680007954312930217046421638900056381294040579168089406073"
SAMPLE_MEDIUM_GRID="201005970000000038036070451000400007400000800020350600695003700000080100000607000"
SAMPLE_HARD_GRID="307410605060000000085006000009504007030000040800103900000200460000000050903065102"

all: $(SOLVER)

run: $(SOLVER)
	./$(SOLVER) $(SAMPLE_MEDIUM_GRID)

test: $(BUILDDIR) $(OBJS) $(TOBJS)
	for i in $(TOBJS); do \
        $(CC) $(OBJS) $$i -o $(BUILDDIR)/test $(LIBS); \
        ./$(BUILDDIR)/test; \
        $(RM) $(BUILDDIR)/test; \
    done

.PHONY: clean
clean:
	$(RM) $(BUILDDIR)

$(SOLVER): $(BUILDDIR) $(OBJS) $(MAIN)
	$(CC) $(OBJS) $(MAIN) -o $(SOLVER) $(LIBS)

$(BUILDDIR)/%.o: $(SRCDIR)/%.c
	$(CC) -c $< -o $@ $(CFLAGS)

$(BUILDDIR):
	$(MKDIR) $(BUILDDIR)

